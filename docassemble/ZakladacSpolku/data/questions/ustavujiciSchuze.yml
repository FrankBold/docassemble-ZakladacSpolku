metadata:
  title: Ustavující schůze
  tags:
    - Schůze
  short title: |
    Ústavující schůze
  description: |
    Rozhraní pro vytvoření zápisu z ústavujícíc schůze
  authors:
    - name: Michal Kuk
      organization: Frank Bold
  revision_date: 2019-11-11
  help label: |
    Nápověda
---
include:
  - t_program.yml
---
sections:
  - intro: Úvodní
  - Průběh schůze:
    - listina: Listina přítomných
    - funkce: Funkcionáři schůze
    - program: Schválení programu schůze
    - stanovy: Schválení stanov
    - organy: Volba orgánů spolku
    - zapis: Pověření osoby zápisem spolku
  - shrnuti: Ukončení schůze
---
features:
  question help button: True
  navigation: horizontal
---
mandatory: True
code: |
  menu_items = [ action_menu_item('Listina přítomných', 'listina') ]
---
interview help:
  label: Nápověda
  heading: Základní nápověda
  content: |
    Základní informace naleznete zde.
---
modules:
  - docassemble.base.legal
  - .validace
---
objects:
  - Spolek: Organization
  - Spolek.schuze: Event
  - Spolek.schuze.pritomni: PartyList.using(there_are_any=False)
  - Spolek.schuze.program: DAList.using(object_type=Thing)
  - Spolek.schuze.program.organClen: PartyList.using(there_are_any=False)
  - Spolek.schuze.predseda: Person
  - Spolek.schuze.zapisovatel: Person
  - Spolek.schuze.overovatel: Person
---
mandatory: True
code: |
  Spolek.schuze.svolavatel = '###'
  Spolek.schuze.datumSvolani = today()
  Spolek.schuze.datumKonani = today()
  Spolek.name.text = 'spolek z.s.'
  Spolek.schuze.obec = 'obec'
---
code: |
  if verze == 'pred':
    Spolek.schuze.predseda = 'Jméno a příjmení, bydliště'
---
mandatory: True
question: |
  Základní volby
fields:
  - Jak chcete nástroj použít?: verze
    input type: radio
    choices:
      - "Připravit podklad na schůzi": pred
      - "Vytvořit zápis z konané schůze": po
---
mandatory: True
question: |
  Základní informace
subquestion: |
  Informace k vyplnění před samotným konáním schůze.
fields:
  - Název spolku: Spolek.name.text
    hint: Včetně dovětku, zpravidla z.s.
    validate: contains_spolek
  - Jméno svolavatele: Spolek.schuze.svolavatel
  - Den konání schůze: Spolek.schuze.datumKonani
    datatype: date
  - Den svolání schůze: Spolek.schuze.datumSvolani
    datatype: date
  - Obec konání schůze: Spolek.schuze.obec
section: intro
---
question: |
  Předseda schůze
subquestion: |
  Prvním bodem schůze je určení předsedajícího, zapisovatele a ověřověvatele zápisu. Stejně jako schválení programu schůze.
fields:
  - Z listiny přítomných: Spolek.schuze.predseda
    datatype: object
    choices: Spolek.schuze.pritomni
    disable others: True
  - Předseda schůze: Spolek.schuze.predseda.name.first
    hint: Jméno a příjmení
  - Bydliště: Spolek.schuze.predseda.address
section: uvod
continue button label: Zapisovatel
---
need: Spolek.schuze.predseda.name.first
question: |
  Zapisovatel
subquestion: |
  Prvním bodem schůze je určení předsedajícího, zapisovatele a ověřověvatele zápisu. Stejně jako schválení programu schůze.
fields:
  - Z listiny přítomných: Spolek.schuze.zapisovatel
    datatype: object
    choices: Spolek.schuze.pritomni
    disable others: True
  - Zapisovatel: Spolek.schuze.zapisovatel.name.first
    hint: Jméno a příjmení
  - Bydliště: Spolek.schuze.zapisovatel.address
section: uvod
continue button label: Ověřovatel zápisu
---
need: Spolek.schuze.zapisovatel.name.first
question: |
  Ověřovatel zápisu
subquestion: |
  Prvním bodem schůze je určení předsedajícího, zapisovatele a ověřověvatele zápisu. Stejně jako schválení programu schůze.
fields:
  - Z listiny přítomných: Spolek.schuze.overovatel
    datatype: object
    choices: Spolek.schuze.pritomni
    disable others: True
  - Ověřovatel zápisu: Spolek.schuze.overovatel.name.first
    hint: Jméno a příjmení
  - Bydliště: Spolek.schuze.overovatel.address
section: uvod
continue button label: Program schůze
continue button field: funkceDone
---
sets: Spolek.schuze.program.there_are_any
code: |
  povinnyProgram = [[t_uvod.subject, t_uvod.content, True], [t_listina.subject, t_listina.content, False], [t_stanovy.subject, t_stanovy.content, True], [t_statutar.subject, t_statutar.content, True], [t_povereni.subject, t_povereni.content, True]]
  for polozka in povinnyProgram:
    Spolek.schuze.program.appendObject()
    Spolek.schuze.program[-1].important = dict(delete=False, edit=False)
    Spolek.schuze.program[-1].name.text = polozka[0]
    Spolek.schuze.program[-1].zapis = polozka[1]
    if polozka[2] == False:
      Spolek.schuze.program[-1].jednomyslne = True
  Spolek.schuze.program.there_is_another = False
  programDefault = True
---
need: programDefault
event: program
question: |
  Program schůze
subquestion: |
  Zde si sestavte program schůze. Můžete též přidat libovolné další body. Program schůze by měl být schválen na začátku.

  ${ Spolek.schuze.program.table }
  
  ${ Spolek.schuze.program.add_action() }
continue button field: programDone
section: program
---
table: Spolek.schuze.program.table
rows: Spolek.schuze.program
columns:
  - Bod: row_item.name.text
edit:
  - row_item.name.text
allow reordering: True
read only: important
---
question: |
  Bod programu
fields:
  - Název bodu: Spolek.schuze.program[i].name.text
---
question: |
  Údaje ${ ordinal(i) } přítomného?
fields:
  - Jméno a příjmení: Spolek.schuze.pritomni[i].name.first
  - Bydliště: Spolek.schuze.pritomni[i].address
  - Přidat další osobu?: Spolek.schuze.pritomni.there_is_another
    datatype: yesnoradio
---
generic object: Person
question: |
  Podepiště se
signature: x.podpis
under: |
  ${ x.name.first }
---
need: programDone
question: |
  Hlasování o bodu schůze: ${ Spolek.schuze.program[i].name.text }
fields:
  - Všichni pro: Spolek.schuze.program[i].jednomyslne
    datatype: yesnoradio
  - Kolik hlasovalo pro: Spolek.schuze.program[i].pro
    datatype: range
    min: 0
    max: ${ Spolek.schuze.pritomni.number() }
    show if:
      variable: Spolek.schuze.program[i].jednomyslne
      is: False
  - Kolik hlasovalo proti: Spolek.schuze.program[i].proti
    datatype: range
    min: 0
    max: ${ Spolek.schuze.pritomni.number() }
    show if:
      variable: Spolek.schuze.program[i].jednomyslne
      is: False
  - Kolik se zdrželo: Spolek.schuze.program[i].zdrzelo
    datatype: range
    min: 0
    max: ${ Spolek.schuze.pritomni.number() }
    show if:
      variable: Spolek.schuze.program[i].jednomyslne
      is: False
validation code: |
  if Spolek.schuze.program[i].jednomyslne == False and Spolek.schuze.program[i].pro + Spolek.schuze.program[i].proti + Spolek.schuze.program[i].zdrzelo != Spolek.schuze.pritomni.number():
    validation_error("Součet musí odpovídát počtu přítomných")
---
code: |
  Spolek.schuze.program[i].important = False
---  
section: shrnuto
mandatory: True
question: |
  Zápis ke stažení
attachment:
  name: Zápis z ustavující schůze
  filename: zapis
  docx template file: Schuze.docx
  valid formats:
    - docx
  
  